from pyspark import SparkContext, SparkConf
import boto3
import os
import numpy as np
import pandas as pd
import librosa
import warnings
from scipy import stats
import json
from pyspark.sql.session import SparkSession
from pyspark.sql.types import FloatType

os.environ["PYSPARK_PYTHON"]="/usr/bin/python3.7"
os.environ["PYSPARK_DRIVER_PYTHON"]="/usr/bin/python3.7"

s3 = boto3.resource('s3')
bucketName = 'yvonneleoo'
conf = SparkConf().setAppName('tiktok-music').setMaster('spark://10.0.0.12:7077')
sc = SparkContext(conf=conf)
spark = SparkSession.builder.appName('tiktok-music').getOrCreate()

#l = [('Alice', 1)]
#a = spark.createDataFrame(l, ['name', 'age']).collect()
#print(l, a)

df = spark.createDataFrame([1.0, 2.0, 3.0], FloatType())
df.show()
df.coalesce(1).write.format("csv").option("header","false").mode("append").save("s3a://yvonneleoo/tiktok-music/")

#df = spark.createDataFrame(dic)
#df.write.parquet('s3a://yvonneleoo/test.parquet', mode='overwrite')
  
